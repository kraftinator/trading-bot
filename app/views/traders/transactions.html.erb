<div class="page-header">
  <div class="row">
    <div class="col-lg-12">
      <h1>Bot <%= @trader.id.to_s %> Transactions</h1>
    </div>
  </div>
</div>

<% if @transactions.any? %>
<div class="row">
  <div class="col-lg-12">
    <table class="table table-striped table-hover sortable">
      <thead>
        <tr>
          <th>BUY ORDER ID</th>
          <th>BUY DATE</th>
          <th>BUY PRICE (<%= "#{@trader.campaign.exchange_trading_pair.coin2.symbol}" %>)</th>
          <th>BUY QTY (<%= "#{@trader.campaign.exchange_trading_pair.coin1.symbol}" %>)</th>
          <th>SELL ORDER ID</th>
          <th>SELL DATE</th>
          <th>SELL PRICE (<%= "#{@trader.campaign.exchange_trading_pair.coin2.symbol}" %>)</th>
          <th>SELL QTY (<%= "#{@trader.campaign.exchange_trading_pair.coin1.symbol}" %>)</th>
          <th>PCT CHANGE</th>
        </tr>
      </thead>
      <tbody>
        <% @transactions.each do |transaction| %>
          <% buy_order = transaction[:buy_order] %>
          <% sell_order = transaction[:sell_order] %>
          <tr>
            <td><%= buy_order.id if buy_order %>
            <td><%= buy_order ? buy_order.filled_at.strftime("%Y-%m-%d %H:%M") : '---' %></td>
            <td><%= buy_order ? number_with_precision( buy_order.price, precision: @trader.campaign.exchange_trading_pair.price_precision ) : '---' %></td>
            <td><%= buy_order ? number_with_precision( buy_order.qty, precision: @trader.campaign.exchange_trading_pair.qty_precision ) : '---' %></td>
            <td><%= sell_order.id if sell_order %>
            <td><%= sell_order ? sell_order.filled_at.strftime("%Y-%m-%d %H:%M") : '---' %></td>
            <td><%= sell_order ? number_with_precision( sell_order.price, precision: @trader.campaign.exchange_trading_pair.price_precision ) : '---' %></td>
            <td><%= sell_order ? number_with_precision( sell_order.qty, precision: @trader.campaign.exchange_trading_pair.qty_precision ) : '---' %></td>
            <td><%= number_to_percentage( 100 - ( ( buy_order.price / sell_order.price ) * 100 ), precision: 3, format: "%n" ) if buy_order and sell_order %></td>
          </tr>  
        <% end %>
      </tbody>
    </table>
  </div>
</div>
<% end %>